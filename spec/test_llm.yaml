top: Aes128Core
algo: AES
params:
  BLOCK_W: 128
  KEY_W: 128
  ROUNDS: 10
bundles:
  Block:
    width: 128
  Key:
    width: 128
  State:
    width: 128
interfaces:
  in:
    dir: in
    type: Decoupled
    payload: Block
  out:
    dir: out
    type: Decoupled
    payload: Block
  key:
    dir: in
    type: Valid
    payload: Key
dag:
- name: KeySchedule128
  kind: KeySchedule
  latency: 11
  out:
  - rk0..rk10
- name: InitRound
  kind: AddRoundKey
  latency: 0
  in:
  - in
  - rk0
  out:
  - s0
- name: Round1
  kind: StdRound
  latency: 2
  in:
  - s0
  - rk1
  out:
  - s1
- name: FinalRound
  kind: FinalRound
  latency: 1
  in:
  - s1
  - rk10
  out:
  - cipher
connections:
- - in
  - InitRound.in
- - InitRound.s0
  - Round1.in
- - Round1.s1
  - FinalRound.in
- - FinalRound.cipher
  - out
verification:
  vectors:
  - nist_kats_aes_ecb.json
  assertions:
  - handshake_no_deadlock
  - const_time_no_secret_branch
security:
  constant_time: true
  forbid_secret_index: true
